<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Random Location from Overpass</title>
<style>
  body { font-family: Arial, sans-serif; margin: 2em; }
  label, input, button { font-size: 1em; }
  #result { margin-top: 1em; padding: 1em; border: 1px solid #ccc; max-width: 600px; }
</style>
</head>
<body>

<h2>Select a city and get a random location</h2>

<form id="cityForm">
  <label for="cityInput">City: </label>
  <input type="text" id="cityInput" value="Gomel" required />
  <button type="submit">Randomize</button>
</form>

<div id="result">Result will appear here...</div>

<script>
  const form = document.getElementById('cityForm');
  const cityInput = document.getElementById('cityInput');
  const resultDiv = document.getElementById('result');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const city = cityInput.value.trim();
    if (!city) {
      resultDiv.textContent = 'Please enter a city name.';
      return;
    }

    resultDiv.textContent = 'Loading data... Please wait.';

    const query = `
[out:json][timeout:180];
area["name"="${city}"]["boundary"="administrative"]["admin_level"="6"]->.a;
(
  node(area.a)[name];
  relation(area.a)[name];
);
out center;
    `;

    try {
      const response = await fetch('https://overpass-api.de/api/interpreter', {
        method: 'POST',
        body: new URLSearchParams({ data: query }),
      });
      if (!response.ok) throw new Error('Network error');

      const data = await response.json();
      const elements = data.elements || [];
      if (elements.length === 0) {
        resultDiv.textContent = `No named locations found in city "${city}".`;
        return;
      }

      const location = elements[Math.floor(Math.random() * elements.length)];
      const locType = location.type;
      const tags = location.tags || {};
      const name = tags.name || 'Unnamed';

      let lat, lon;
      if (locType === 'node') {
        lat = location.lat;
        lon = location.lon;
      } else if (location.center) {
        lat = location.center.lat;
        lon = location.center.lon;
      } else {
        lat = lon = null;
      }

      resultDiv.innerHTML = `
        <strong>Random Location:</strong><br>
        Type: ${locType}<br>
        Name: ${name}<br>
        Coordinates: ${lat !== null && lon !== null ? lat.toFixed(6) + ', ' + lon.toFixed(6) : 'Not available'}
      `;

    } catch (error) {
      resultDiv.textContent = 'Error: ' + error.message;
    }
  });
</script>

</body>
</html>
